<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900"
      rel="stylesheet"
    />
    <link href="/css/materialdesignicons.min.css" rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css"
      rel="stylesheet"
    />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
    />
  </head>
  <body>
    <div id="app">
      <v-app>
        <v-stepper v-model="currentStep" vertical>
          <v-stepper-step :complete="currentStep > 1" step="1">
            Select a process
          </v-stepper-step>

          <v-stepper-content step="1">
            <v-autocomplete
              v-model="selectedProcess"
              :items="[
              'Test Process'
            ]"
              outlined
              required
            ></v-autocomplete>
            <v-btn
              color="primary"
              :disabled="!selectedProcess"
              @click="currentStep++"
            >
              Continue
            </v-btn>
            <v-btn text @click="navigateParent('/')"> Cancel </v-btn>
          </v-stepper-content>

          <v-stepper-step :complete="currentStep > 2" step="2">
            Select a product
          </v-stepper-step>

          <v-stepper-content step="2">
            <div></div>
            <v-btn color="primary" @click="currentStep++"> Continue </v-btn>
            <v-btn text @click="currentStep--"> Back </v-btn>
          </v-stepper-content>

          <v-stepper-step :complete="currentStep > 3" step="3">
            Select cloud
          </v-stepper-step>

          <v-stepper-content step="3">
            <v-autocomplete
              v-model="selectedCloud"
              :items="[
              'Space Applications Services',
              'Terradue'
            ]"
              outlined
            ></v-autocomplete>
            <v-btn
              color="primary"
              :disabled="!selectedCloud"
              @click="currentStep++"
            >
              Continue
            </v-btn>
            <v-btn text @click="currentStep--"> Back </v-btn>
          </v-stepper-content>

          <v-stepper-step step="4">
            Review and start processing
          </v-stepper-step>
          <v-stepper-content step="4">
            <h1>Summary</h1>
            <p>Process: {{ selectedProcess }}</p>
            <p>Product: {{ selectedProduct }}</p>
            <p>Cloud: {{ selectedCloud }}</p>
            <v-checkbox
              v-model="tosAgreed"
              label="I agree to the processing Terms of Service"
            ></v-checkbox>
            <v-btn
              color="success"
              :disabled="!tosAgreed"
              @click="currentStep = 1"
            >
              <v-icon left> mdi-cloud-cog-outline </v-icon>
              Start Processing
            </v-btn>
            <v-btn text @click="currentStep--"> Back </v-btn>
          </v-stepper-content>
        </v-stepper>
      </v-app>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      new Vue({
        el: "#app",
        vuetify: new Vuetify(),
        data: () => ({
          currentStep: 1,
          selectedProcess: null,
          selectedProduct: null,
          selectedCloud: null,
          tosAgreed: null,
        }),
        async created() {
          const params = new URLSearchParams();
          params.append("scope", "openid user_name is_operator");
          params.append("grant_type", "password");
          params.append("username", "osc");
          params.append("password", "<pwd>");
          params.append("client_id", "eba82eb7-5cb0-4f5e-99ab-3830eef383e2!");
          const auth = await axios.post(
            "https://auth.eoepca-staging.spaceapplications.com/oxauth/restv1/token",
            params,
            {
              headers: {
                "Cache-Control": "no-cache",
                "Content-Type": "application/x-www-form-urlencoded",
              },
            }
          );
          // const result = await axios.post('https://eoepca-staging.spaceapplications.com/ades/osc/wps3/processes', {}, {
          //   headers: {
          //     'X-User-Id': 'test'
          //   }
          // })
          console.log(auth);
          debugger;
        },
        methods: {
          navigateParent(newPath) {
            window.parent.postMessage(
              { type: "navigation", path: newPath },
              "*"
            );
          },
        },
      });
    </script>
  </body>
</html>
